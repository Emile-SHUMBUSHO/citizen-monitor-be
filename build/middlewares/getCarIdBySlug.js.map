{"version":3,"file":"getCarIdBySlug.js","names":["req","res","next","include","model","db","as","attributes","exclude","Galleries","FindOne","slug","params","car","console","log","errors","Object","keys","length","status","BAD_REQUEST","json","error","body","carId","id"],"sources":["../../src/middlewares/getCarIdBySlug.js"],"sourcesContent":["import status from '../config/status'\nimport { FindOne } from '../database/queries'\nimport db from '../database/models'\n\nexport default async (req, res, next) => {\n  const include = [\n    {\n      model: db['CarType'],\n      as: 'carType',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n    },\n    {\n      model: db['CarMake'],\n      as: 'carMake',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n    },\n    {\n      model: db['CarMeta'],\n      as: 'carMeta',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n    },\n    {\n      model: db['RentingInformation'],\n      as: 'RentingInformation',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n    },\n    {\n      model: db.Galleries,\n      as: 'Galleries',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n    },\n    {\n      model: db['Profile'],\n      as: 'owner',\n      attributes: { exclude: ['createdAt', 'updatedAt'] },\n      include: {\n        model: db['User'],\n        as: 'profile',\n        attributes: { exclude: ['password', 'createdAt', 'updatedAt'] },\n      },\n    },\n  ]\n  const car = await FindOne('Car', { slug: req.params.slug }, include)\n  console.log('car', car)\n  if (car.errors || !Object.keys(car).length > 0) {\n    return res.status(status.BAD_REQUEST).json({\n      error: 'The car you are looking for can not be found at this moment.',\n    })\n  }\n  req.car = car\n  req.body.carId = car.id\n  next()\n}\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AAAmC;EAAA,yFAEpB,iBAAOA,GAAG,EAAEC,GAAG,EAAEC,IAAI;IAAA;IAAA;MAAA;QAAA;UAAA;YAC5BC,OAAO,GAAG,CACd;cACEC,KAAK,EAAEC,kBAAE,CAAC,SAAS,CAAC;cACpBC,EAAE,EAAE,SAAS;cACbC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE;YACpD,CAAC,EACD;cACEJ,KAAK,EAAEC,kBAAE,CAAC,SAAS,CAAC;cACpBC,EAAE,EAAE,SAAS;cACbC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE;YACpD,CAAC,EACD;cACEJ,KAAK,EAAEC,kBAAE,CAAC,SAAS,CAAC;cACpBC,EAAE,EAAE,SAAS;cACbC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE;YACpD,CAAC,EACD;cACEJ,KAAK,EAAEC,kBAAE,CAAC,oBAAoB,CAAC;cAC/BC,EAAE,EAAE,oBAAoB;cACxBC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE;YACpD,CAAC,EACD;cACEJ,KAAK,EAAEC,kBAAE,CAACI,SAAS;cACnBH,EAAE,EAAE,WAAW;cACfC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE;YACpD,CAAC,EACD;cACEJ,KAAK,EAAEC,kBAAE,CAAC,SAAS,CAAC;cACpBC,EAAE,EAAE,OAAO;cACXC,UAAU,EAAE;gBAAEC,OAAO,EAAE,CAAC,WAAW,EAAE,WAAW;cAAE,CAAC;cACnDL,OAAO,EAAE;gBACPC,KAAK,EAAEC,kBAAE,CAAC,MAAM,CAAC;gBACjBC,EAAE,EAAE,SAAS;gBACbC,UAAU,EAAE;kBAAEC,OAAO,EAAE,CAAC,UAAU,EAAE,WAAW,EAAE,WAAW;gBAAE;cAChE;YACF,CAAC,CACF;YAAA;YAAA,OACiB,IAAAE,gBAAO,EAAC,KAAK,EAAE;cAAEC,IAAI,EAAEX,GAAG,CAACY,MAAM,CAACD;YAAK,CAAC,EAAER,OAAO,CAAC;UAAA;YAA9DU,GAAG;YACTC,OAAO,CAACC,GAAG,CAAC,KAAK,EAAEF,GAAG,CAAC;YAAA,MACnBA,GAAG,CAACG,MAAM,IAAI,CAACC,MAAM,CAACC,IAAI,CAACL,GAAG,CAAC,CAACM,MAAM,GAAG,CAAC;cAAA;cAAA;YAAA;YAAA,iCACrClB,GAAG,CAACmB,MAAM,CAACA,kBAAM,CAACC,WAAW,CAAC,CAACC,IAAI,CAAC;cACzCC,KAAK,EAAE;YACT,CAAC,CAAC;UAAA;YAEJvB,GAAG,CAACa,GAAG,GAAGA,GAAG;YACbb,GAAG,CAACwB,IAAI,CAACC,KAAK,GAAGZ,GAAG,CAACa,EAAE;YACvBxB,IAAI,EAAE;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CACP;EAAA;IAAA;EAAA;AAAA;AAAA"}